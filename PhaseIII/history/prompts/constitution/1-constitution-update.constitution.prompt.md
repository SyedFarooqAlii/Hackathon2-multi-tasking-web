---
id: 1
title: "Constitution Update - Phase III Todo AI Chatbot"
stage: constitution
date_iso: "2026-02-05"
surface: "agent"
model: "claude-sonnet-4-5-20250929"
feature: "none"
branch: "001-frontend-ux-integration"
user: "user"
command: "/sp.constitution"
labels: ["constitution", "todo-chatbot", "mcp", "stateless"]
spec: null
ticket: null
adr: null
pr: null
files_yaml:
  - ".specify/memory/constitution.md"
  - "history/prompts/constitution/1-constitution-update.constitution.prompt.md"
tests_yaml: []
---

# Constitution Update - Phase III Todo AI Chatbot

## Prompt Text

```
# Spec Constitution — Phase III (Todo AI Chatbot)

## Authority
This constitution is the highest authority for Phase III.
If generated code, plans, or specs conflict with this document, they are INVALID and must be regenerated by updating the spec (not manual edits).

## Core Objective
Build an AI-powered Todo Chatbot that manages tasks via natural language using:
- OpenAI Agents SDK
- Official MCP SDK
- Stateless FastAPI backend
- Database-persisted conversation state

## Hard Constraints (Non-Negotiable)
- ❌ No manual coding by humans
- ✅ Agentic Dev Stack only: Spec → Plan → Tasks → Claude Code
- ✅ All task operations MUST go through MCP tools
- ✅ FastAPI server must be stateless
- ✅ Conversation state stored in database
- ❌ No business logic inside frontend
- ❌ No direct DB access from agent (only via MCP)

## Architecture Rules
- Frontend: OpenAI ChatKit (UI only)
- Backend: FastAPI
- AI Logic: OpenAI Agents SDK
- Tool Layer: MCP Server (Official SDK)
- DB: Neon PostgreSQL + SQLModel
- Auth: Better Auth

## MCP Enforcement
The agent MUST:
- Use MCP tools for add, list, update, complete, delete tasks
- NEVER manipulate tasks directly
- Treat MCP tools as the single source of truth

## Stateless Conversation Flow
Each request MUST:
1. Fetch conversation history from DB
2. Append new user message
3. Run agent with MCP tools
4. Persist assistant response
5. Return response
Server MUST retain no in-memory state.

## Agent Behavior Rules
- Infer user intent from natural language
- Select correct MCP tool
- Confirm every action in natural language
- Handle errors gracefully (task not found, invalid input)

## Data Models (Required)
- Task: id, user_id, title, description, completed, created_at, updated_at
- Conversation: id, user_id, created_at, updated_at
- Message: id, conversation_id, role, content, created_at

## Deliverables
- /frontend (ChatKit UI)
- /backend (FastAPI + Agents SDK + MCP)
- /specs (agent + MCP + API specs)
- DB migrations
- README with setup

## Evaluation Criteria
- Correct MCP usage
- Stateless correctness
- Natural language accuracy
- Tool invocation transparency
- Spec-driven development discipline
```

## Response Text

Updated the project constitution to reflect Phase III requirements for the Todo AI Chatbot with OpenAI Agents SDK, MCP enforcement, and stateless architecture. The constitution now mandates:
- MCP tools as the single source of truth for task operations
- Stateless FastAPI backend with database-persisted conversation state
- Agent behavior rules for natural language processing
- Required data models for tasks, conversations, and messages

## Outcome

Successfully updated the constitution from version 1.1.0 to 1.2.0, replacing the Phase II Todo Web Application constitution with Phase III Todo AI Chatbot requirements. The new constitution emphasizes MCP enforcement, stateless architecture, and AI-powered natural language interaction.